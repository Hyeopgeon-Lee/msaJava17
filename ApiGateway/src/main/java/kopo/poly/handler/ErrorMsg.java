package kopo.poly.handler;

import lombok.AllArgsConstructor;
import lombok.Getter;

/**
 * 도메인 표준 에러 메시지 집합.
 * <p>
 * 설계 원칙
 * - 클라이언트에 노출 가능한 "사람 친화적인" 메시지만 포함한다(내부 예외/스택트레이스 금지).
 * - HTTP 상태코드와 1:1 매핑하지 않는다. (HTTP Status는 컨트롤러/핸들러에서 결정)
 * - 동일한 HTTP 상태라도 상황에 따라 다른 도메인 코드/메시지를 선택할 수 있다.
 * <p>
 * 권장 사용 패턴
 * - 401(미인증) 흐름: ERR100, ERR300, ERR400, ERR410, ERR310, ERR330
 * - 403(무권한) 흐름: ERR600
 * - 400/409 등 비즈니스 충돌: 별도 비즈니스용 코드 추가를 권장(본 Enum은 인증/인가 중심)
 * <p>
 * 다국어(국제화)
 * - 현재 값(value)은 한국어 고정 문자열이다.
 * - 다국어가 필요하면 메시지 키만 두고, 실제 문구는 MessageSource(리소스 번들)로 관리하는 방식을 권장.
 * <p>
 * 주의
 * - 에러 상세(예: 어떤 토큰이 왜 실패했는지)는 로그로만 남기고, 사용자 메시지는 간결/안전하게 유지한다.
 */
@Getter
@AllArgsConstructor
public enum ErrorMsg {

    /**
     * 인증이 필요한 요청인데 인증 정보가 전혀 없거나 유효하지 않을 때(일반적인 401 안내 문구).
     */
    ERR100("인증이 필요합니다."),

    /**
     * 액세스/리프레시 토큰 모두 누락된 경우(쿠키/헤더 모두 없음).
     */
    ERR300("액세스/리프레시 토큰이 없습니다."),
    /**
     * 토큰 파싱 단계에서 형식 오류/디코딩 실패 등(서명 검증 전 단계의 파싱 실패).
     */
    ERR310("토큰 파싱 오류가 발생했습니다."),
    /**
     * 리프레시 토큰 자체가 변조/서명불일치 등으로 유효하지 않을 때.
     */
    ERR320("유효하지 않은 리프레시 토큰입니다."),
    /**
     * 액세스/리프레시 공통적으로 유효성 검증 실패(서명/클레임 불일치 등) 시 범용 문구.
     */
    ERR330("유효하지 않은 토큰입니다."),

    /**
     * 액세스 토큰이 요구되지만 존재하지 않을 때(헤더/쿠키 모두에 없음).
     */
    ERR400("액세스 토큰이 없습니다."),
    /**
     * 액세스 토큰이 만료(exp 초과)된 경우.
     */
    ERR410("액세스 토큰이 만료되었습니다."),

    /**
     * 리프레시 토큰이 요구되지만 존재하지 않을 때(쿠키 등 저장소에 없음).
     */
    ERR500("리프레시 토큰이 없습니다."),
    /**
     * 리프레시 토큰이 만료된 경우(재발급 불가).
     */
    ERR510("리프레시 토큰이 만료되었습니다."),

    /**
     * 인증은 되었으나 권한(role/authority)이 부족해 접근이 거부될 때(일반적인 403).
     */
    ERR600("접근 권한이 없습니다.");

    /**
     * 클라이언트에 노출할 사용자 친화 메시지(민감 정보 금지).
     */
    private final String value;
}
